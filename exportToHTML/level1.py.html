<html>
<head>
<title>level1.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #a5c261;}
.s3 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
level1.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">webapp2</span>
page_header = <span class="s2">&quot;&quot;&quot; 
&lt;!doctype html&gt; 
&lt;html&gt; 
  &lt;head&gt; 
    &lt;!-- Internal game scripts/styles, mostly boring stuff --&gt; 
    &lt;script src=&quot;https://xss-game.appspot.com/static/game-frame.js&quot;&gt;&lt;/script&gt; 
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://xss-game.appspot.com/static/game-frame-styles.css&quot; /&gt; 
  &lt;/head&gt; 
 
  &lt;body id=&quot;level1&quot;&gt; 
    &lt;img src=&quot;./level1.png&quot;/&gt; 
      &lt;div&gt; 
&quot;&quot;&quot;</span>

<span class="s1">page_footer = </span><span class="s2">&quot;&quot;&quot; 
    &lt;/div&gt; 
  &lt;/body&gt; 
&lt;/html&gt; 
&quot;&quot;&quot;</span>

<span class="s1">main_page_markup = </span><span class="s2">&quot;&quot;&quot; 
&lt;form action=&quot;&quot; method=&quot;GET&quot;&gt; 
  &lt;input id=&quot;query&quot; name=&quot;query&quot; value=&quot;Enter query here...&quot; 
    onfocus=&quot;this.value=''&quot;&gt; 
  &lt;input id=&quot;button&quot; type=&quot;submit&quot; value=&quot;Search&quot;&gt; 
&lt;/form&gt; 
&quot;&quot;&quot;</span>


<span class="s0">class </span><span class="s1">MainPage(webapp2.RequestHandler):</span>

    <span class="s0">def </span><span class="s1">render_string(self</span><span class="s0">, </span><span class="s1">s):</span>
        self.response.out.write(s)

    <span class="s0">def </span><span class="s1">get(self):</span>
        <span class="s3"># Disable the reflected XSS filter for demonstration purposes</span>
        <span class="s1">self.response.headers.add_header(</span><span class="s2">&quot;X-XSS-Protection&quot;</span><span class="s0">, </span><span class="s2">&quot;0&quot;</span><span class="s1">)</span>

        <span class="s0">if not </span><span class="s1">self.request.get(</span><span class="s2">'query'</span><span class="s1">):</span>
            <span class="s3"># Show main search page</span>
            <span class="s1">self.render_string(page_header + main_page_markup + page_footer)</span>
        <span class="s0">else</span><span class="s1">:</span>
            query = self.request.get(<span class="s2">'query'</span><span class="s0">, </span><span class="s2">'[empty]'</span><span class="s1">)</span>

            <span class="s3"># Our search engine broke, we found no results :-(</span>
            <span class="s1">message = </span><span class="s2">&quot;Sorry, no results were found for &lt;b&gt;&quot; </span><span class="s1">+ query + </span><span class="s2">&quot;&lt;/b&gt;.&quot;</span>
            <span class="s1">message += </span><span class="s2">&quot; &lt;a href='?'&gt;Try again&lt;/a&gt;.&quot;</span>

            <span class="s3"># Display the results page</span>
            <span class="s1">self.render_string(page_header + message + page_footer)</span>

        <span class="s0">return</span>


<span class="s1">application = webapp2.WSGIApplication([(</span><span class="s2">'.*'</span><span class="s0">, </span><span class="s1">MainPage)</span><span class="s0">, </span><span class="s1">]</span><span class="s0">, </span><span class="s1">debug=False)</span>

<span class="s0">def </span><span class="s1">main():</span>
    <span class="s0">from </span><span class="s1">paste </span><span class="s0">import </span><span class="s1">httpserver</span>
    httpserver.serve(application<span class="s0">, </span><span class="s1">host=</span><span class="s2">'127.0.0.1'</span><span class="s0">, </span><span class="s1">port=</span><span class="s2">'8080'</span><span class="s1">)</span>

<span class="s0">if </span><span class="s1">__name__ == </span><span class="s2">'__main__'</span><span class="s1">:</span>
    main()</pre>
</body>
</html>